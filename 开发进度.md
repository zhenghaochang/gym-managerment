# å¥èº«æˆ¿ç®¡ç†ç³»ç»Ÿå¼€å‘è¿›åº¦

## é¡¹ç›®ä¿¡æ¯
- å‰ç«¯ï¼šVue3 + Element Plus + Pinia + Vue Router
- åç«¯ï¼šSpring Boot 2.7.18 + Spring Security + JWT + Redis
- æ•°æ®åº“ï¼šMySQL

---

## âœ… å·²å®ŒæˆåŠŸèƒ½

### åç«¯éƒ¨åˆ†
1. **Spring Security + JWT é›†æˆ**
   - SecurityConfig é…ç½®ï¼ˆç¦ç”¨ CSRFã€Sessionï¼Œé…ç½®ç™½åå•ï¼‰
   - JwtAuthenticationTokenFilter è¿‡æ»¤å™¨ï¼ˆä» Redis è·å–ç”¨æˆ·ä¿¡æ¯ï¼‰
   - JwtUtil å·¥å…·ç±»ï¼ˆç”Ÿæˆ/è§£æ tokenï¼Œå¯†é’¥è‡³å°‘ 32 å­—ç¬¦ï¼‰
   - RedisUtil å·¥å…·ç±»ï¼ˆå­˜å–ç”¨æˆ·ä¿¡æ¯ï¼‰
   - æ–‡ä»¶ï¼š`user/src/main/java/zhenghc/config/SecurityConfig.java`
   - æ–‡ä»¶ï¼š`user/src/main/java/zhenghc/filter/JwtAuthenticationTokenFilter.java`

2. **ç™»å½•æ¥å£**
   - è·¯å¾„ï¼šPOST `/api/user/login`
   - è¿”å›æ ¼å¼ï¼š`{ resCode: "00", resMsg: "æ“ä½œæˆåŠŸ", result: { token, user } }`
   - ç”¨æˆ·æƒé™é€šè¿‡ SQL å…³è”æŸ¥è¯¢ï¼ˆuser â†’ user_role â†’ role_permission â†’ permissionï¼‰
   - æƒé™å­˜å‚¨åœ¨ User å¯¹è±¡çš„ `permissions` å­—æ®µï¼ˆList<String>ï¼‰
   - ç™»å½•æ—¶å°†ç”¨æˆ·ä¿¡æ¯å­˜å…¥ Redisï¼ˆkey: USER_ID_KEY + userIdï¼‰

### å‰ç«¯éƒ¨åˆ†
1. **ç™»å½•æ³¨å†Œé¡µé¢**
   - æ¸å˜èƒŒæ™¯ + å¡ç‰‡è®¾è®¡
   - è¡¨å•æ ¡éªŒï¼ˆElement Plus + å¼¹çª—æç¤ºï¼‰
   - éªŒè¯ç åŠŸèƒ½
   - å¯¹æ¥åç«¯ç™»å½•æ¥å£
   - æ–‡ä»¶ï¼š`gym-front/src/views/login.vue`, `register.vue`

2. **å…¬å…±æ ·å¼ç³»ç»Ÿ**
   - æå–åˆ° `gym-front/src/style/` ç›®å½•
   - åŒ…å«ï¼šcommon.css, form.css, button.css, components.css
   - ç»Ÿä¸€å…¥å£ï¼šindex.css

3. **ä¸»å¸ƒå±€ç³»ç»Ÿ**
   - å·¦ä¾§èœå•ï¼š`MainMenu.vue`ï¼ˆæ·±è‰²ç³»ï¼Œä½è°ƒå¥¢åï¼‰
   - é¡¶éƒ¨å¯¼èˆªï¼š`Navigation.vue`ï¼ˆæ·±è‰²ç³»ï¼Œç»Ÿä¸€é£æ ¼ï¼‰
   - ç™»å½•æ³¨å†Œé¡µç‹¬ç«‹å¸ƒå±€ï¼ˆæ— èœå•å¯¼èˆªï¼‰
   - ä¸»é¢˜è‰²ï¼šç´«è‰²ç³» (#667eea, #89b4fa)

4. **åŠ¨æ€æƒé™èœå•**
   - Pinia Storeï¼š`gym-front/src/stores/permission.js`
   - èœå•é…ç½®ï¼š`gym-front/src/utils/menuConfig.js`
   - `transformPermissionsToMenusByCode()` å‡½æ•°ï¼šæ ¹æ®æƒé™ä»£ç æ•°ç»„ç”Ÿæˆèœå•æ ‘
   - æ”¯æŒ 4 ç§è§’è‰²ï¼šsuperAdmin, admin, coach, member
   - åŸºäº SQL æƒé™è¡¨ç»“æ„è®¾è®¡

5. **API æ¶æ„**
   - å•ä½“æ¶æ„ï¼šç»Ÿä¸€æœåŠ¡ apiServiceï¼ˆç«¯å£ 8081ï¼‰
   - ç»Ÿä¸€æ‹¦æˆªå™¨ï¼šè‡ªåŠ¨æ·»åŠ  Bearer tokenã€é”™è¯¯å¤„ç†ã€401 è·³è½¬
   - å“åº”æ‹¦æˆªå™¨é€‚é… `resCode === '00'` åˆ¤æ–­
   - API æ¨¡å—ï¼šuser.js, member.js, course.js, order.js

6. **è·¯ç”±å®ˆå«**
   - æœªç™»å½•è®¿é—®ç³»ç»Ÿé¡µ â†’ è·³è½¬ç™»å½•
   - å·²ç™»å½•è®¿é—®ç™»å½•é¡µ â†’ è·³è½¬ Dashboard
   - é€€å‡ºç™»å½•æ¸…é™¤ token å’Œ Store

---

## ğŸš§ è¿›è¡Œä¸­

### å‰åç«¯è”è°ƒæµ‹è¯•
- [x] ç™»å½•æ¥å£å¯¹æ¥
- [ ] æµ‹è¯•ç™»å½•åŠŸèƒ½æ˜¯å¦æ­£å¸¸
- [ ] å®ç°æ³¨å†Œæ¥å£
- [ ] å®Œå–„é€€å‡ºç™»å½•åŠŸèƒ½ï¼ˆæ¸…é™¤ Redis ä¸­çš„ç”¨æˆ·ä¿¡æ¯ï¼‰

---

## ğŸ“‹ å¾…åŠåŠŸèƒ½

### åç«¯æ¨¡å—
- [ ] æ³¨å†Œæ¥å£
- [ ] é€€å‡ºç™»å½•æ¥å£
- [ ] ç”¨æˆ·ç®¡ç†æ¨¡å—
- [ ] ä¼šå‘˜ç®¡ç†æ¨¡å—
- [ ] è¯¾ç¨‹ç®¡ç†æ¨¡å—
- [ ] è®¢å•ç®¡ç†æ¨¡å—
- [ ] å™¨æ¢°ç®¡ç†æ¨¡å—
- [ ] è´¢åŠ¡ç®¡ç†æ¨¡å—

### å‰ç«¯é¡µé¢
- [ ] Dashboard é¡µé¢
- [ ] ç³»ç»Ÿç®¡ç†é¡µé¢
- [ ] ä¼šå‘˜ç®¡ç†é¡µé¢
- [ ] è¯¾ç¨‹ç®¡ç†é¡µé¢
- [ ] å…¶ä»–ä¸šåŠ¡é¡µé¢

---

## ğŸ“ æŠ€æœ¯è¦ç‚¹

### åç«¯é…ç½®
```yaml
# application.yml
server:
  port: 8081
  servlet:
    context-path: /api

spring:
  redis:
    host: localhost
    port: 6379
    password: ä½ çš„rediså¯†ç 

sky:
  jwt:
    secretKey: gym-management-system-jwt-secret-key-2024  # è‡³å°‘32å­—ç¬¦
    timeMill: 604800000  # 7å¤©
```

### JWT ä¾èµ–ï¼ˆpom.xmlï¼‰
```xml
<!-- JJWT 0.11.5 éœ€è¦ä¸‰ä¸ªä¾èµ– -->
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-api</artifactId>
    <version>0.11.5</version>
</dependency>
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-impl</artifactId>
    <version>0.11.5</version>
    <scope>runtime</scope>
</dependency>
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-jackson</artifactId>
    <version>0.11.5</version>
    <scope>runtime</scope>
</dependency>
```

### æ ·å¼é£æ ¼
- æ·±è‰²ç³»ä¸»é¢˜ï¼ˆèœå•ã€å¯¼èˆªæ ï¼‰
- ç´«è‰²ç³»ä¸»é¢˜è‰² (#667eea, #764ba2)
- ç®€çº¦å¤§æ–¹æœ‰è´¨æ„Ÿï¼Œä½è°ƒä½†é«˜çº§

### è¡¨å•æ ¡éªŒ
- å¿…å¡«å­—æ®µä½¿ç”¨ `change` è§¦å‘ï¼ˆçŸ­ä¿¡éªŒè¯ç é™¤å¤–ç”¨ `blur`ï¼‰
- è¾“å…¥æ¡†ä¸‹æ–¹çº¢è‰²æç¤º + å¼¹çª—æç¤º

### æƒé™è®¾è®¡
- åŸºäº SQL æƒé™è¡¨ï¼ˆid, permission_name, permission_code, resource_type, url, parent_id, sort_orderï¼‰
- èœå•ç±»å‹æƒé™ï¼ˆresource_type='menu'ï¼‰
- æ ‘å½¢ç»“æ„ï¼ˆparent_id å…³è”ï¼‰
- ç”¨æˆ·æƒé™æŸ¥è¯¢ï¼šuser â†’ user_role â†’ role_permission â†’ permission

---

## ğŸ”§ å¼€å‘ç¯å¢ƒ

### å‰ç«¯
- Node.js ç‰ˆæœ¬ï¼šï¼ˆå¾…ç¡®è®¤ï¼‰
- åŒ…ç®¡ç†å™¨ï¼šnpm
- å¼€å‘æœåŠ¡å™¨ï¼šViteï¼ˆè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼‰

### åç«¯
- JDK ç‰ˆæœ¬ï¼šï¼ˆå¾…ç¡®è®¤ï¼‰
- æ„å»ºå·¥å…·ï¼šMaven
- æœåŠ¡ç«¯å£ï¼š8081ï¼ˆcontext-path: /apiï¼‰

---

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. ä½¿ç”¨ Spring Security çš„ SecurityContextHolder æ›¿ä»£ ThreadLocal
2. JWT å¯†é’¥å¿…é¡»è‡³å°‘ 32 å­—ç¬¦ï¼ˆHS256 è¦æ±‚ï¼‰
3. JJWT 0.11.5 éœ€è¦ä¸‰ä¸ªä¾èµ–ï¼ˆapiã€implã€jacksonï¼‰
4. Redis å¦‚æœè®¾ç½®äº†å¯†ç ï¼Œyml ä¸­å¿…é¡»é…ç½®
5. å¯åŠ¨ç±»å¿…é¡»åœ¨æ‰€æœ‰ Controller çš„çˆ¶åŒ…ä¸‹
6. è·¨åŸŸå¿…é¡»åœ¨ SecurityConfig ä¸­é…ç½®ï¼ŒController çš„ @CrossOrigin å¯èƒ½è¢« Security æ‹¦æˆª
7. SecurityConfig ç™½åå•è·¯å¾„ä¸éœ€è¦åŠ  context-pathï¼ˆå¦‚ `/user/login` è€Œä¸æ˜¯ `/api/user/login`ï¼‰
8. Lombok @Data å¦‚æœä¸ç”Ÿæ•ˆï¼Œæ‰‹åŠ¨å†™ getter/setter

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

1. æµ‹è¯•å‰ç«¯ç™»å½•åŠŸèƒ½
2. å®ç°æ³¨å†Œæ¥å£
3. å®Œå–„é€€å‡ºç™»å½•åŠŸèƒ½
4. åˆ›å»º Dashboard é¡µé¢
5. å¼€å‘å…·ä½“ä¸šåŠ¡æ¨¡å—

---

**æœ€åæ›´æ–°ï¼š** 2024-12-28
**å½“å‰é˜¶æ®µï¼š** ç™»å½•åŠŸèƒ½å®Œæˆï¼Œå‡†å¤‡æµ‹è¯•è”è°ƒ
